*** qemu-4.1.0-clean/accel/tcg/cpu-exec.c	2019-08-15 14:01:42.000000000 -0500
--- qemu-4.1.0/accel/tcg/cpu-exec.c	2019-10-27 00:20:15.997628472 -0500
***************
*** 38,43 ****
--- 38,45 ----
  #include "sysemu/cpus.h"
  #include "sysemu/replay.h"
  
+ #include "../patches/afl-qemu-cpu-inl.h"
+ 
  /* -icount align implementation. */
  
  typedef struct SyncClocks {
***************
*** 146,151 ****
--- 148,155 ----
      int tb_exit;
      uint8_t *tb_ptr = itb->tc.ptr;
  
+     AFL_QEMU_CPU_SNIPPET2;
+ 
      qemu_log_mask_and_addr(CPU_LOG_EXEC, itb->pc,
                             "Trace %d: %p ["
                             TARGET_FMT_lx "/" TARGET_FMT_lx "/%#x] %s\n",
***************
*** 247,252 ****
--- 251,257 ----
          if (tb == NULL) {
              mmap_lock();
              tb = tb_gen_code(cpu, pc, cs_base, flags, cflags);
+             AFL_QEMU_CPU_SNIPPET1;
              mmap_unlock();
          }
  
